<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç "“∞—Å—Ç–∞–∑"</title>
    <link rel="icon" href="data:,">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .demo-content {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .demo-text {
            line-height: 1.6;
            color: #666;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="demo-content">
        <h1>AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç "“∞—Å—Ç–∞–∑"</h1>
        <p class="demo-text">
            –î–µ–º–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–∂–µ—Ç–∞ —á–∞—Ç-–±–æ—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π retrieval-augmented generation (RAG). –≠—Ç–æ—Ç –≤–∏–¥–∂–µ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π.
        </p>
    </div>

    <!-- Chatbot Widget Script -->
    <script>
        (function() {
            // Configuration
            const CHATBOT_CONFIG = {
                // apiBaseUrl: 'https://chat.orleu.edu.kz',
                apiBaseUrl: 'http://localhost:8000', // Change to your API base URL
                apiKey: 'your-api-key-here', // Set if API key authentication is enabled
                theme: {
                    primaryColor: '#007bff',
                    backgroundColor: '#f8f9fa',
                    textColor: '#333',
                    botMessageColor: '#e9ecef',
                    userMessageColor: '#007bff'
                },
                position: 'bottom-right', // bottom-right, bottom-left
                triggerText: 'üí¨',
                title: 'AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç',
                subtitle: '–ö–∞–∫ —è –º–æ–≥—É –ø–æ–º–æ—á—å?',
                placeholder: '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...',
                welcomeMessage: '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø –≤–∞—à AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –ö–∞–∫ —è –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º —Å–µ–≥–æ–¥–Ω—è?'
            };

            let sessionId = null;
            let isOpen = false;
            let messageHistory = [];

            // Create chatbot HTML structure
            function createChatbotHTML() {
                const position = CHATBOT_CONFIG.position === 'bottom-left' ? 'left: 20px;' : 'right: 20px;';
                
                return `
                    <!-- Chatbot Trigger Button -->
                    <div id="chatbot-trigger" style="
                        position: fixed;
                        bottom: 20px;
                        ${position}
                        width: 60px;
                        height: 60px;
                        background: ${CHATBOT_CONFIG.theme.primaryColor};
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        cursor: pointer;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                        z-index: 1000;
                        transition: all 0.3s ease;
                        font-size: 24px;
                        color: white;
                    ">
                        ${CHATBOT_CONFIG.triggerText}
                    </div>

                    <!-- Chatbot Widget -->
                    <div id="chatbot-widget" style="
                        position: fixed;
                        bottom: 90px;
                        ${position}
                        width: 350px;
                        height: 500px;
                        background: white;
                        border-radius: 10px;
                        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
                        z-index: 1001;
                        display: none;
                        flex-direction: column;
                        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    ">
                        <!-- Header -->
                        <div style="
                            background: ${CHATBOT_CONFIG.theme.primaryColor};
                            color: white;
                            padding: 15px;
                            border-radius: 10px 10px 0 0;
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                        ">
                            <div>
                                <div style="font-weight: 600; font-size: 16px;">${CHATBOT_CONFIG.title}</div>
                                <div style="font-size: 12px; opacity: 0.9;">${CHATBOT_CONFIG.subtitle}</div>
                            </div>
                            <div id="chatbot-close" style="
                                cursor: pointer;
                                font-size: 20px;
                                padding: 5px;
                                border-radius: 3px;
                                transition: background 0.2s;
                            ">√ó</div>
                        </div>

                        <!-- Messages Container -->
                        <div id="chatbot-messages" style="
                            flex: 1;
                            overflow-y: auto;
                            padding: 15px;
                            background: ${CHATBOT_CONFIG.theme.backgroundColor};
                        ">
                            <div class="bot-message" style="
                                background: ${CHATBOT_CONFIG.theme.botMessageColor};
                                padding: 10px 12px;
                                border-radius: 18px 18px 18px 4px;
                                margin-bottom: 10px;
                                max-width: 80%;
                                font-size: 14px;
                                line-height: 1.4;
                            ">
                                ${CHATBOT_CONFIG.welcomeMessage}
                            </div>
                        </div>

                        <!-- Input Container -->
                        <div style="
                            padding: 15px;
                            border-top: 1px solid #eee;
                            background: white;
                            border-radius: 0 0 10px 10px;
                        ">
                            <div style="display: flex; gap: 10px;">
                                <input 
                                    id="chatbot-input" 
                                    type="text" 
                                    placeholder="${CHATBOT_CONFIG.placeholder}"
                                    style="
                                        flex: 1;
                                        padding: 10px;
                                        border: 1px solid #ddd;
                                        border-radius: 6px;
                                        font-size: 14px;
                                        outline: none;
                                    "
                                />
                                <button id="chatbot-send" style="
                                    background: ${CHATBOT_CONFIG.theme.primaryColor};
                                    color: white;
                                    border: none;
                                    padding: 10px 15px;
                                    border-radius: 6px;
                                    cursor: pointer;
                                    font-size: 14px;
                                ">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>

                        <!-- Loading indicator -->
                        <div id="chatbot-loading" style="display: none; padding: 15px; text-align: center; color: #666;">
                            <div style="display: inline-block; animation: spin 1s linear infinite;">‚ü≥</div>
                            –ò—â—É –æ—Ç–≤–µ—Ç... –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ.
                        </div>
                    </div>

                    <style>
                        @keyframes spin {
                            0% { transform: rotate(0deg); }
                            100% { transform: rotate(360deg); }
                        }
                        
                        #chatbot-trigger:hover {
                            transform: scale(1.1);
                        }
                        
                        #chatbot-close:hover {
                            background: rgba(255,255,255,0.2);
                        }
                        
                        #chatbot-messages::-webkit-scrollbar {
                            width: 6px;
                        }
                        
                        #chatbot-messages::-webkit-scrollbar-track {
                            background: #f1f1f1;
                        }
                        
                        #chatbot-messages::-webkit-scrollbar-thumb {
                            background: #c1c1c1;
                            border-radius: 3px;
                        }
                    </style>
                `;
            }

            // Initialize chatbot
            function initChatbot() {
                // Inject HTML
                document.body.insertAdjacentHTML('beforeend', createChatbotHTML());

                // Get elements
                const trigger = document.getElementById('chatbot-trigger');
                const widget = document.getElementById('chatbot-widget');
                const closeBtn = document.getElementById('chatbot-close');
                const input = document.getElementById('chatbot-input');
                const sendBtn = document.getElementById('chatbot-send');
                const messages = document.getElementById('chatbot-messages');
                const loading = document.getElementById('chatbot-loading');

                // Event listeners
                trigger.addEventListener('click', toggleWidget);
                closeBtn.addEventListener('click', toggleWidget);
                sendBtn.addEventListener('click', sendMessage);
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });

                // Functions
                function toggleWidget() {
                    isOpen = !isOpen;
                    widget.style.display = isOpen ? 'flex' : 'none';
                    if (isOpen) {
                        input.focus();
                        createSessionIfNeeded();
                    }
                }

                async function createSessionIfNeeded() {
                    if (!sessionId) {
                        try {
                            const response = await fetch(`${CHATBOT_CONFIG.apiBaseUrl}/sessions`, {
                                method: 'POST',
                                headers: getHeaders()
                            });
                            const data = await response.json();
                            sessionId = data.session_id;
                        } catch (error) {
                            console.error('Failed to create session:', error);
                        }
                    }
                }

                function getHeaders() {
                    const headers = {
                        'Content-Type': 'application/json'
                    };
                    if (CHATBOT_CONFIG.apiKey) {
                        headers['Authorization'] = `Bearer ${CHATBOT_CONFIG.apiKey}`;
                    }
                    return headers;
                }

                async function sendMessage() {
                    const message = input.value.trim();
                    if (!message) return;

                    // Add user message to chat
                    addMessage(message, 'user');
                    input.value = '';
                    
                    // Show loading
                    loading.style.display = 'block';
                    messages.scrollTop = messages.scrollHeight;

                    try {
                        const response = await fetch(`${CHATBOT_CONFIG.apiBaseUrl}/chat`, {
                            method: 'POST',
                            headers: getHeaders(),
                            body: JSON.stringify({
                                message: message,
                                session_id: sessionId,
                                mode: 'generated'
                            })
                        });

                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const data = await response.json();
                        
                        // Update session ID if new
                        if (data.session_id) {
                            sessionId = data.session_id;
                        }

                        // Add bot response
                        addMessage(data.response, 'bot');

                    } catch (error) {
                        console.error('Chat error:', error);
                        addMessage('Sorry, I encountered an error. Please try again.', 'bot');
                    } finally {
                        loading.style.display = 'none';
                    }
                }

                function addMessage(text, sender) {
                    const isBot = sender === 'bot';
                    const messageDiv = document.createElement('div');
                    
                    messageDiv.style.cssText = `
                        background: ${isBot ? CHATBOT_CONFIG.theme.botMessageColor : CHATBOT_CONFIG.theme.userMessageColor};
                        color: ${isBot ? CHATBOT_CONFIG.theme.textColor : 'white'};
                        padding: 10px 12px;
                        border-radius: ${isBot ? '18px 18px 18px 4px' : '18px 18px 4px 18px'};
                        margin-bottom: 10px;
                        margin-left: ${isBot ? '0' : 'auto'};
                        margin-right: ${isBot ? 'auto' : '0'};
                        max-width: 80%;
                        font-size: 14px;
                        line-height: 1.4;
                        word-wrap: break-word;
                    `;
                    
                    messageDiv.textContent = text;
                    messages.appendChild(messageDiv);
                    messages.scrollTop = messages.scrollHeight;
                    
                    messageHistory.push({ sender, text, timestamp: new Date() });
                }
            }

            // Initialize when DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initChatbot);
            } else {
                initChatbot();
            }
        })();
    </script>
</body>
</html>